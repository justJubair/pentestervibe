import { FC, useRef, useState } from 'react';

import { IoStar, IoChevronForward, IoChevronBack } from 'react-icons/io5';
import { Swiper, SwiperRef, SwiperSlide } from 'swiper/react';

import 'swiper/css';
import 'swiper/css/effect-coverflow';
import 'swiper/css/pagination';
import 'swiper/css/navigation';

import { EffectCoverflow } from 'swiper/modules';
import { reviewSectionData } from '../../assets/home-static-data';
import { cn } from '../../utils/helper';

const ReviewSection: FC = () => {
	const swiperRef = useRef<SwiperRef | null>(null);
	const [activeIndex, setActiveIndex] = useState(2);

	const handlePrev = () => {
		swiperRef.current?.swiper?.slidePrev();
	};

	const handleNext = () => {
		swiperRef.current?.swiper?.slideNext();
	};

	return (
		<div className='relative w-full wrapper mt-28 lg:px-7'>
			<h1 className='w-full flex justify-start h-10'>
				<img
					src='/svg/shapes/home-page/header-review.svg'
					alt='second-section-header'
				/>
			</h1>

			<div className='mt-14 rounded-lg overflow-hidden'>
				<Swiper
					ref={swiperRef}
					effect={'coverflow'}
					grabCursor={true}
					centeredSlides={true}
					loop={true}
					slidesPerView={2}
					spaceBetween={-405}
					coverflowEffect={{
						rotate: 0,
						stretch: 0,
						depth: 100,
						modifier: 2.5,
					}}
					modules={[EffectCoverflow]}
					onActiveIndexChange={(swiper) => {
						setActiveIndex(swiper.realIndex);
					}}
					className='relative'
				>
					{[...reviewSectionData, ...reviewSectionData].map((data, index) => (
						<SwiperSlide key={index} className='swiper_slide'>
							<div
								className={cn(
									'w-full max-w-lg mx-auto p-10 rounded-2xl bg-[#120821]',
									{
										'bg-gradient-to-r from-[#A949CF] to-[#DA84DD]':
											activeIndex === index,
									}
								)}
							>
								<div className='flex items-center justify-between'>
									<div className='flex-grow'>
										<h2
											className={cn(
												'text-gray-400 text-2xl font-inter font-semibold',
												{
													'text-white': activeIndex === index,
												}
											)}
										>
											{data.name}
										</h2>

										<h2
											className={cn('mt-2 text-gray-400 text-lg', {
												'text-gray-200': activeIndex === index,
											})}
										>
											{data.title}
										</h2>
									</div>

									<div className='flex items-center gap-1.5'>
										{[...Array(5)].map((_, i) => (
											<IoStar
												key={i}
												className={cn('text-yellow-400 text-xl', {
													'text-yellow-300': activeIndex === index,
												})}
											/>
										))}
									</div>
								</div>

								<p
									className={cn('mt-5 tracking-wide font-inter text-gray-400', {
										'text-black/80': activeIndex === index,
									})}
								>
									{data.description}
								</p>
							</div>
						</SwiperSlide>
					))}

					<div className='absolute w-full z-20 top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 flex items-center justify-between'>
						<button
							type='button'
							onClick={handlePrev}
							className='bg-glass backdrop-blur-lg p-4 rounded-full hover:bg-gradient-to-r from-[#A949CF] to-[#DA84DD]'
						>
							<IoChevronBack className='text-white text-3xl' />
						</button>

						<button
							type='button'
							onClick={handleNext}
							className='bg-glass backdrop-blur-lg p-4 rounded-full hover:bg-gradient-to-r from-[#DA84DD] to-[#A949CF]'
						>
							<IoChevronForward className='text-white text-3xl' />
						</button>
					</div>
				</Swiper>
			</div>
		</div>
	);
};

export default ReviewSection;
