import { FC } from 'react';
import { BarChart, Bar, XAxis, YAxis, Tooltip, Legend, ResponsiveContainer, Rectangle, TooltipProps } from 'recharts';
import { CSSProperties } from 'react';
import './chart.css';

// data array
const data = [
    { name: 'Jan', Registered: 10, Subscribed: 5 },
    { name: 'Feb', Registered: 25, Subscribed: 3 },
    { name: 'Mar', Registered: 15, Subscribed: 17 },
    { name: 'Apr', Registered: 5, Subscribed: 2 },
    { name: 'May', Registered: 10, Subscribed: 5 },
    { name: 'Jun', Registered: 15, Subscribed: 8 },
    { name: 'Jul', Registered: 25, Subscribed: 15 },
];

// custom backround for each row
const CustomBackground = (props: any) => {
    const { x, y, width, height, index } = props;
    return (
        <Rectangle
            fill="#4740583B"
            x={x - 20}
            y={7}
            width={width + 70}
            height={470}
            radius={10}
            stroke="none"
        />
    );
};

// custom tooltip
const CustomTooltip: FC<TooltipProps<any, any>> = ({ active, payload, label, coordinate }) => {
    if (active && payload && payload.length && coordinate) {
        const tooltipStyle: CSSProperties = {
            backgroundColor: '#fff',
            width: '138px',
            borderRadius: '10px',
            padding: '13px',
            color: '#000',
            position: 'absolute',
            left: `${(coordinate.x || 0) - 0}px`,
            top: `${(coordinate.y || 0) - 100}px`,
            transform: 'translateX(-50%)',
            pointerEvents: 'none',
        };

        return (
            <div style={tooltipStyle}>
                <p className='font-medium flex items-center justify-between'><span className='text-[#8C26C6]'>Registered</span> {`${payload[0].value}`}</p>
                <p className='font-medium flex items-center justify-between'><span className='text-[#F87DFC]'>Subscribed</span> {`${payload[1].value}`}</p>
            </div>
        );
    }

    return null;
};

const Chart: FC = () => {
    return (
        <div className='flex'>
            <ResponsiveContainer width="100%" height={500}>
                <BarChart data={data} margin={{ top: 5, right: 30, left: 20, bottom: 5 }} barGap={12}>
                    <XAxis dataKey="name" tickMargin={15} stroke="#fff" />
                    <YAxis stroke="#fff" />
                    <Tooltip trigger='hover' content={<CustomTooltip />} />
                    <Legend />
                    <Bar dataKey="Registered" fill="#8C26C6" barSize={16} radius={[10, 10, 10, 10]} background={<CustomBackground />} />
                    <Bar dataKey="Subscribed" fill="#F87DFC" barSize={16} radius={[10, 10, 10, 10]} />
                </BarChart>
            </ResponsiveContainer>
        </div>
    );
};

export default Chart;
